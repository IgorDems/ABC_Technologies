pipeline {
    agent { label 'agent193' }
    stages {
        stage('Kubernetes Deployment') {
            steps {
                configFileProvider([
                    configFile(fileId: 'kubeconfig.yml', variable: 'KUBECONFIG')
                ]) {
                    sh 'kubectl get nodes'
                    sh 'kubectl apply -f k8s/deployment.yaml'
                    sh 'kubectl apply -f k8s/service.yaml'
                }
            }
        }
    }
}